<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>1837938fe7cf42128db78425723a43af</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell code" id="NYAFkGgApFtR">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<section id="credit-card-users-churn-prediction" class="cell markdown"
id="9a54fa0f">
<h1>Credit Card Users Churn Prediction</h1>
</section>
<section id="problem-statement" class="cell markdown" id="9EaJ8AGwpM-2">
<h2>Problem Statement</h2>
</section>
<div class="cell markdown" id="x3-QehJxbp0t">
<h3 id="business-context">Business Context</h3>
<p>The Thera bank recently saw a steep decline in the number of users of
their credit card, credit cards are a good source of income for banks
because of different kinds of fees charged by the banks like annual
fees, balance transfer fees, and cash advance fees, late payment fees,
foreign transaction fees, and others. Some fees are charged to every
user irrespective of usage, while others are charged under specified
circumstances.</p>
<p>Customers’ leaving credit cards services would lead bank to loss, so
the bank wants to analyze the data of customers and identify the
customers who will leave their credit card services and reason for same
– so that bank could improve upon those areas</p>
<p>You as a Data scientist at Thera bank need to come up with a
classification model that will help the bank improve its services so
that customers do not renounce their credit cards</p>
<h3 id="data-description">Data Description</h3>
<ul>
<li>CLIENTNUM: Client number. Unique identifier for the customer holding
the account</li>
<li>Attrition_Flag: Internal event (customer activity) variable - if the
account is closed then "Attrited Customer" else "Existing Customer"</li>
<li>Customer_Age: Age in Years</li>
<li>Gender: Gender of the account holder</li>
<li>Dependent_count: Number of dependents</li>
<li>Education_Level: Educational Qualification of the account holder -
Graduate, High School, Unknown, Uneducated, College(refers to college
student), Post-Graduate, Doctorate</li>
<li>Marital_Status: Marital Status of the account holder</li>
<li>Income_Category: Annual Income Category of the account holder</li>
<li>Card_Category: Type of Card</li>
<li>Months_on_book: Period of relationship with the bank (in
months)</li>
<li>Total_Relationship_Count: Total no. of products held by the
customer</li>
<li>Months_Inactive_12_mon: No. of months inactive in the last 12
months</li>
<li>Contacts_Count_12_mon: No. of Contacts in the last 12 months</li>
<li>Credit_Limit: Credit Limit on the Credit Card</li>
<li>Total_Revolving_Bal: Total Revolving Balance on the Credit Card</li>
<li>Avg_Open_To_Buy: Open to Buy Credit Line (Average of last 12
months)</li>
<li>Total_Amt_Chng_Q4_Q1: Change in Transaction Amount (Q4 over Q1)</li>
<li>Total_Trans_Amt: Total Transaction Amount (Last 12 months)</li>
<li>Total_Trans_Ct: Total Transaction Count (Last 12 months)</li>
<li>Total_Ct_Chng_Q4_Q1: Change in Transaction Count (Q4 over Q1)</li>
<li>Avg_Utilization_Ratio: Average Card Utilization Ratio</li>
</ul>
<h4 id="what-is-a-revolving-balance">What Is a Revolving Balance?</h4>
<ul>
<li>If we don't pay the balance of the revolving credit account in full
every month, the unpaid portion carries over to the next month. That's
called a revolving balance</li>
</ul>
<h5 id="what-is-the-average-open-to-buy">What is the Average Open to
buy?</h5>
<ul>
<li>'Open to Buy' means the amount left on your credit card to use. Now,
this column represents the average of this value for the last 12
months.</li>
</ul>
<h5 id="what-is-the-average-utilization-ratio">What is the Average
utilization Ratio?</h5>
<ul>
<li>The Avg_Utilization_Ratio represents how much of the available
credit the customer spent. This is useful for calculating credit
scores.</li>
</ul>
<h5
id="relation-bw-avg_open_to_buy-credit_limit-and-avg_utilization_ratio">Relation
b/w Avg_Open_To_Buy, Credit_Limit and Avg_Utilization_Ratio:</h5>
<ul>
<li>( Avg_Open_To_Buy / Credit_Limit ) + Avg_Utilization_Ratio = 1</li>
</ul>
</div>
<section
id="please-read-the-instructions-carefully-before-starting-the-project"
class="cell markdown" id="NbHOIdlwcrqR">
<h3><strong>Please read the instructions carefully before starting the
project.</strong></h3>
<p>This is a commented Jupyter IPython Notebook file in which all the
instructions and tasks to be performed are mentioned.</p>
<ul>
<li>Blanks '_______' are provided in the notebook that needs to be
filled with an appropriate code to get the correct result. With every
'_______' blank, there is a comment that briefly describes what needs to
be filled in the blank space.</li>
<li>Identify the task to be performed correctly, and only then proceed
to write the required code.</li>
<li>Fill the code wherever asked by the commented lines like "# write
your code here" or "# complete the code". Running incomplete code may
throw error.</li>
<li>Please run the codes in a sequential manner from the beginning to
avoid any unnecessary errors.</li>
<li>Add the results/observations (wherever mentioned) derived from the
analysis in the presentation and submit the same.</li>
</ul>
</section>
<section id="importing-necessary-libraries" class="cell markdown"
id="v_-uuGqH-qTt">
<h2>Importing necessary libraries</h2>
</section>
<div class="cell code" data-execution_count="18" id="83D17_Wl4jal">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import necessary libraries</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for data loading and analysis</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># For visualization</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code></pre></div>
</div>
<section id="loading-the-dataset" class="cell markdown"
id="xxhpZv9y-qTw">
<h2>Loading the dataset</h2>
</section>
<div class="cell code" data-execution_count="19"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="An2IXPEdzpym" data-outputId="b4e31fe1-2b77-432a-f524-ea66bd7ebf7d">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mount to Google Drive</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">&#39;/content/drive&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(&quot;/content/drive&quot;, force_remount=True).
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="20"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:255}"
id="BBCc4HbKz_yL" data-outputId="311146ea-8aa2-4a91-bcaa-a3183e2a7004">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Load dataset</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>datapath <span class="op">=</span><span class="st">&#39;/content/drive/My Drive/mldatasets/BankChurners.csv&#39;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>card_dataset <span class="op">=</span> pd.read_csv(datapath)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>card_dataset.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="20">

  <div id="df-e65b3799-6db6-493a-ae53-3330b0103a17" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CLIENTNUM</th>
      <th>Attrition_Flag</th>
      <th>Customer_Age</th>
      <th>Gender</th>
      <th>Dependent_count</th>
      <th>Education_Level</th>
      <th>Marital_Status</th>
      <th>Income_Category</th>
      <th>Card_Category</th>
      <th>Months_on_book</th>
      <th>...</th>
      <th>Months_Inactive_12_mon</th>
      <th>Contacts_Count_12_mon</th>
      <th>Credit_Limit</th>
      <th>Total_Revolving_Bal</th>
      <th>Avg_Open_To_Buy</th>
      <th>Total_Amt_Chng_Q4_Q1</th>
      <th>Total_Trans_Amt</th>
      <th>Total_Trans_Ct</th>
      <th>Total_Ct_Chng_Q4_Q1</th>
      <th>Avg_Utilization_Ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>768805383</td>
      <td>Existing Customer</td>
      <td>45</td>
      <td>M</td>
      <td>3</td>
      <td>High School</td>
      <td>Married</td>
      <td>$60K - $80K</td>
      <td>Blue</td>
      <td>39</td>
      <td>...</td>
      <td>1</td>
      <td>3</td>
      <td>12691.0</td>
      <td>777</td>
      <td>11914.0</td>
      <td>1.335</td>
      <td>1144</td>
      <td>42</td>
      <td>1.625</td>
      <td>0.061</td>
    </tr>
    <tr>
      <th>1</th>
      <td>818770008</td>
      <td>Existing Customer</td>
      <td>49</td>
      <td>F</td>
      <td>5</td>
      <td>Graduate</td>
      <td>Single</td>
      <td>Less than $40K</td>
      <td>Blue</td>
      <td>44</td>
      <td>...</td>
      <td>1</td>
      <td>2</td>
      <td>8256.0</td>
      <td>864</td>
      <td>7392.0</td>
      <td>1.541</td>
      <td>1291</td>
      <td>33</td>
      <td>3.714</td>
      <td>0.105</td>
    </tr>
    <tr>
      <th>2</th>
      <td>713982108</td>
      <td>Existing Customer</td>
      <td>51</td>
      <td>M</td>
      <td>3</td>
      <td>Graduate</td>
      <td>Married</td>
      <td>$80K - $120K</td>
      <td>Blue</td>
      <td>36</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>3418.0</td>
      <td>0</td>
      <td>3418.0</td>
      <td>2.594</td>
      <td>1887</td>
      <td>20</td>
      <td>2.333</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>769911858</td>
      <td>Existing Customer</td>
      <td>40</td>
      <td>F</td>
      <td>4</td>
      <td>High School</td>
      <td>NaN</td>
      <td>Less than $40K</td>
      <td>Blue</td>
      <td>34</td>
      <td>...</td>
      <td>4</td>
      <td>1</td>
      <td>3313.0</td>
      <td>2517</td>
      <td>796.0</td>
      <td>1.405</td>
      <td>1171</td>
      <td>20</td>
      <td>2.333</td>
      <td>0.760</td>
    </tr>
    <tr>
      <th>4</th>
      <td>709106358</td>
      <td>Existing Customer</td>
      <td>40</td>
      <td>M</td>
      <td>3</td>
      <td>Uneducated</td>
      <td>Married</td>
      <td>$60K - $80K</td>
      <td>Blue</td>
      <td>21</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>4716.0</td>
      <td>0</td>
      <td>4716.0</td>
      <td>2.175</td>
      <td>816</td>
      <td>28</td>
      <td>2.500</td>
      <td>0.000</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e65b3799-6db6-493a-ae53-3330b0103a17')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e65b3799-6db6-493a-ae53-3330b0103a17 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e65b3799-6db6-493a-ae53-3330b0103a17');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-19e921b0-b566-420c-a172-104f44ebe449">
  <button class="colab-df-quickchart" onclick="quickchart('df-19e921b0-b566-420c-a172-104f44ebe449')"
            title="Suggest charts."
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-19e921b0-b566-420c-a172-104f44ebe449 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<section id="data-overview" class="cell markdown" id="UvpMDcaaMKtI">
<h2>Data Overview</h2>
</section>
<div class="cell markdown" id="tIiCRwqZ54_C">
<ul>
<li>Observations</li>
<li>Sanity checks</li>
</ul>
</div>
<div class="cell code" data-execution_count="21"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="kqfkIqPY19Cn" data-outputId="b46705e1-39e7-46cb-9c25-36cef6a2fc33">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many rows and columns are there</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>card_dataset.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="21">
<pre><code>(10127, 21)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="22"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="rJwUC4Ah0Y2K" data-outputId="87532e0c-d6e8-40ea-fb47-138c6cfc9aa2">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get info about columns.</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>card_dataset.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 10127 entries, 0 to 10126
Data columns (total 21 columns):
 #   Column                    Non-Null Count  Dtype  
---  ------                    --------------  -----  
 0   CLIENTNUM                 10127 non-null  int64  
 1   Attrition_Flag            10127 non-null  object 
 2   Customer_Age              10127 non-null  int64  
 3   Gender                    10127 non-null  object 
 4   Dependent_count           10127 non-null  int64  
 5   Education_Level           8608 non-null   object 
 6   Marital_Status            9378 non-null   object 
 7   Income_Category           10127 non-null  object 
 8   Card_Category             10127 non-null  object 
 9   Months_on_book            10127 non-null  int64  
 10  Total_Relationship_Count  10127 non-null  int64  
 11  Months_Inactive_12_mon    10127 non-null  int64  
 12  Contacts_Count_12_mon     10127 non-null  int64  
 13  Credit_Limit              10127 non-null  float64
 14  Total_Revolving_Bal       10127 non-null  int64  
 15  Avg_Open_To_Buy           10127 non-null  float64
 16  Total_Amt_Chng_Q4_Q1      10127 non-null  float64
 17  Total_Trans_Amt           10127 non-null  int64  
 18  Total_Trans_Ct            10127 non-null  int64  
 19  Total_Ct_Chng_Q4_Q1       10127 non-null  float64
 20  Avg_Utilization_Ratio     10127 non-null  float64
dtypes: float64(5), int64(10), object(6)
memory usage: 1.6+ MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="7"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="hi5yxM0R1Ud6" data-outputId="98a5b839-0d11-4c98-8545-20434f383385">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print sample records of columns, which are not numeric.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>card_dataset.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;object&#39;</span>]).head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="7">

  <div id="df-4902234a-76f4-46e4-a83d-b29a2b42a8b3" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Attrition_Flag</th>
      <th>Gender</th>
      <th>Education_Level</th>
      <th>Marital_Status</th>
      <th>Income_Category</th>
      <th>Card_Category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Existing Customer</td>
      <td>M</td>
      <td>High School</td>
      <td>Married</td>
      <td>$60K - $80K</td>
      <td>Blue</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Existing Customer</td>
      <td>F</td>
      <td>Graduate</td>
      <td>Single</td>
      <td>Less than $40K</td>
      <td>Blue</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Existing Customer</td>
      <td>M</td>
      <td>Graduate</td>
      <td>Married</td>
      <td>$80K - $120K</td>
      <td>Blue</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Existing Customer</td>
      <td>F</td>
      <td>High School</td>
      <td>NaN</td>
      <td>Less than $40K</td>
      <td>Blue</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Existing Customer</td>
      <td>M</td>
      <td>Uneducated</td>
      <td>Married</td>
      <td>$60K - $80K</td>
      <td>Blue</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4902234a-76f4-46e4-a83d-b29a2b42a8b3')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4902234a-76f4-46e4-a83d-b29a2b42a8b3 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4902234a-76f4-46e4-a83d-b29a2b42a8b3');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-a11ca1c6-242a-46dc-964b-9e149717f5c6">
  <button class="colab-df-quickchart" onclick="quickchart('df-a11ca1c6-242a-46dc-964b-9e149717f5c6')"
            title="Suggest charts."
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-a11ca1c6-242a-46dc-964b-9e149717f5c6 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="8"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:519}"
id="8xcl3K7c1jXC" data-outputId="17155efb-02e6-4663-a344-a56d6c800437">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get statistical summary on numerical columns.</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>card_dataset.describe().T</span></code></pre></div>
<div class="output execute_result" data-execution_count="8">

  <div id="df-608f6b4c-786b-4a85-ac0c-6bd9778d76af" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CLIENTNUM</th>
      <td>10127.0</td>
      <td>7.391776e+08</td>
      <td>3.690378e+07</td>
      <td>708082083.0</td>
      <td>7.130368e+08</td>
      <td>7.179264e+08</td>
      <td>7.731435e+08</td>
      <td>8.283431e+08</td>
    </tr>
    <tr>
      <th>Customer_Age</th>
      <td>10127.0</td>
      <td>4.632596e+01</td>
      <td>8.016814e+00</td>
      <td>26.0</td>
      <td>4.100000e+01</td>
      <td>4.600000e+01</td>
      <td>5.200000e+01</td>
      <td>7.300000e+01</td>
    </tr>
    <tr>
      <th>Dependent_count</th>
      <td>10127.0</td>
      <td>2.346203e+00</td>
      <td>1.298908e+00</td>
      <td>0.0</td>
      <td>1.000000e+00</td>
      <td>2.000000e+00</td>
      <td>3.000000e+00</td>
      <td>5.000000e+00</td>
    </tr>
    <tr>
      <th>Months_on_book</th>
      <td>10127.0</td>
      <td>3.592841e+01</td>
      <td>7.986416e+00</td>
      <td>13.0</td>
      <td>3.100000e+01</td>
      <td>3.600000e+01</td>
      <td>4.000000e+01</td>
      <td>5.600000e+01</td>
    </tr>
    <tr>
      <th>Total_Relationship_Count</th>
      <td>10127.0</td>
      <td>3.812580e+00</td>
      <td>1.554408e+00</td>
      <td>1.0</td>
      <td>3.000000e+00</td>
      <td>4.000000e+00</td>
      <td>5.000000e+00</td>
      <td>6.000000e+00</td>
    </tr>
    <tr>
      <th>Months_Inactive_12_mon</th>
      <td>10127.0</td>
      <td>2.341167e+00</td>
      <td>1.010622e+00</td>
      <td>0.0</td>
      <td>2.000000e+00</td>
      <td>2.000000e+00</td>
      <td>3.000000e+00</td>
      <td>6.000000e+00</td>
    </tr>
    <tr>
      <th>Contacts_Count_12_mon</th>
      <td>10127.0</td>
      <td>2.455317e+00</td>
      <td>1.106225e+00</td>
      <td>0.0</td>
      <td>2.000000e+00</td>
      <td>2.000000e+00</td>
      <td>3.000000e+00</td>
      <td>6.000000e+00</td>
    </tr>
    <tr>
      <th>Credit_Limit</th>
      <td>10127.0</td>
      <td>8.631954e+03</td>
      <td>9.088777e+03</td>
      <td>1438.3</td>
      <td>2.555000e+03</td>
      <td>4.549000e+03</td>
      <td>1.106750e+04</td>
      <td>3.451600e+04</td>
    </tr>
    <tr>
      <th>Total_Revolving_Bal</th>
      <td>10127.0</td>
      <td>1.162814e+03</td>
      <td>8.149873e+02</td>
      <td>0.0</td>
      <td>3.590000e+02</td>
      <td>1.276000e+03</td>
      <td>1.784000e+03</td>
      <td>2.517000e+03</td>
    </tr>
    <tr>
      <th>Avg_Open_To_Buy</th>
      <td>10127.0</td>
      <td>7.469140e+03</td>
      <td>9.090685e+03</td>
      <td>3.0</td>
      <td>1.324500e+03</td>
      <td>3.474000e+03</td>
      <td>9.859000e+03</td>
      <td>3.451600e+04</td>
    </tr>
    <tr>
      <th>Total_Amt_Chng_Q4_Q1</th>
      <td>10127.0</td>
      <td>7.599407e-01</td>
      <td>2.192068e-01</td>
      <td>0.0</td>
      <td>6.310000e-01</td>
      <td>7.360000e-01</td>
      <td>8.590000e-01</td>
      <td>3.397000e+00</td>
    </tr>
    <tr>
      <th>Total_Trans_Amt</th>
      <td>10127.0</td>
      <td>4.404086e+03</td>
      <td>3.397129e+03</td>
      <td>510.0</td>
      <td>2.155500e+03</td>
      <td>3.899000e+03</td>
      <td>4.741000e+03</td>
      <td>1.848400e+04</td>
    </tr>
    <tr>
      <th>Total_Trans_Ct</th>
      <td>10127.0</td>
      <td>6.485869e+01</td>
      <td>2.347257e+01</td>
      <td>10.0</td>
      <td>4.500000e+01</td>
      <td>6.700000e+01</td>
      <td>8.100000e+01</td>
      <td>1.390000e+02</td>
    </tr>
    <tr>
      <th>Total_Ct_Chng_Q4_Q1</th>
      <td>10127.0</td>
      <td>7.122224e-01</td>
      <td>2.380861e-01</td>
      <td>0.0</td>
      <td>5.820000e-01</td>
      <td>7.020000e-01</td>
      <td>8.180000e-01</td>
      <td>3.714000e+00</td>
    </tr>
    <tr>
      <th>Avg_Utilization_Ratio</th>
      <td>10127.0</td>
      <td>2.748936e-01</td>
      <td>2.756915e-01</td>
      <td>0.0</td>
      <td>2.300000e-02</td>
      <td>1.760000e-01</td>
      <td>5.030000e-01</td>
      <td>9.990000e-01</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-608f6b4c-786b-4a85-ac0c-6bd9778d76af')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-608f6b4c-786b-4a85-ac0c-6bd9778d76af button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-608f6b4c-786b-4a85-ac0c-6bd9778d76af');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-52d9c492-a23c-4259-bedb-9681c591a820">
  <button class="colab-df-quickchart" onclick="quickchart('df-52d9c492-a23c-4259-bedb-9681c591a820')"
            title="Suggest charts."
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-52d9c492-a23c-4259-bedb-9681c591a820 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="24"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="Nzv1r2te3psj" data-outputId="ec351f66-8ddc-42f3-fabc-ad021e06eb92">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get count of missing values for each column</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>result_ds <span class="op">=</span> card_dataset.isnull().<span class="bu">sum</span>() <span class="op">&gt;</span> <span class="dv">0</span> <span class="co"># This performs columnwise sum operation for True values.</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>result_ds [result_ds <span class="op">&gt;</span> <span class="dv">0</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="24">
<pre><code>Education_Level    True
Marital_Status     True
dtype: bool</code></pre>
</div>
</div>
<section id="exploratory-data-analysis-eda" class="cell markdown"
id="j-yGG8LNSSMa">
<h2>Exploratory Data Analysis (EDA)</h2>
</section>
<div class="cell markdown" id="3bGVKmh75ri8">
<ul>
<li>EDA is an important part of any project involving data.</li>
<li>It is important to investigate and understand the data better before
building a model with it.</li>
<li>A few questions have been mentioned below which will help you
approach the analysis in the right manner and generate insights from the
data.</li>
<li>A thorough analysis of the data, in addition to the questions
mentioned below, should be done.</li>
</ul>
</div>
<div class="cell markdown" id="oEyqzdJBb0jU">
<p><strong>Questions</strong>:</p>
<ol>
<li>How is the total transaction amount distributed?</li>
<li>What is the distribution of the level of education of
customers?</li>
<li>What is the distribution of the level of income of customers?</li>
<li>How does the change in transaction amount between Q4 and Q1
(<code>total_ct_change_Q4_Q1</code>) vary by the customer's account
status (<code>Attrition_Flag</code>)?</li>
<li>How does the number of months a customer was inactive in the last 12
months (<code>Months_Inactive_12_mon</code>) vary by the customer's
account status (<code>Attrition_Flag</code>)?</li>
<li>What are the attributes that have a strong correlation with each
other?</li>
</ol>
</div>
<div class="cell markdown" id="250qx1O953zu">
<p>How is the total transaction amount distributed?</p>
</div>
<div class="cell code" data-execution_count="36"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="jgYmJWTK52V9" data-outputId="481a5ad6-f99c-43b8-bde3-027a7702f2f2">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive way</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>card_dataset.Total_Trans_Amt.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="36">
<pre><code>count    10127.000000
mean      4404.086304
std       3397.129254
min        510.000000
25%       2155.500000
50%       3899.000000
75%       4741.000000
max      18484.000000
Name: Total_Trans_Amt, dtype: float64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="25"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:472}"
id="xVi8qknY6Qb2" data-outputId="674af026-f10f-4c67-9840-3a0855bf92bf">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visual way by using Histogram.</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>plt.hist(card_dataset.Total_Trans_Amt , bins <span class="op">=</span> <span class="dv">20</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Transaction Amoutn&#39;</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Total Transaction Amout Distribution&#39;</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_5aa77c461f9d4ebfbf5ebba86d1cd7c1/61c9f12efa8ca06b38dee6eb929973ef875302f6.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="41"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:472}"
id="K1nwzfxA90Ln" data-outputId="eaa95f91-70c3-45cd-cf76-7be198b4d358">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lets visualize in boxbplot</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span>card_dataset.Total_Trans_Amt)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Total transaction Amout&#39;</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Box plot for Total Trnasaction Amout&#39;</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_5aa77c461f9d4ebfbf5ebba86d1cd7c1/cc27beca490856627a93e61b4f3cd99fa8eed91a.png" /></p>
</div>
</div>
<div class="cell markdown" id="As-RgpNKKezQ">
<ul>
<li>50% of Total Transaction Amout distributed between IQR ( Between Q1
&amp; Q3 ) 2500 to 5000</li>
<li>Lower whisker is aprox 500 and higher whisker is 8000.</li>
<li>There are multiple outliers are there. Aprox &gt; 8500 all are
outliers.</li>
</ul>
</div>
<div class="cell markdown" id="I16KQitk-W7Z">
<p>What is the distribution of the level of education of customers?</p>
</div>
<div class="cell code" data-execution_count="12"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="yNW1xAHR-YeX" data-outputId="7241c4ba-2cb5-430f-ae81-be3c4996af6c">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Business Context</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>card_dataset.Education_Level.value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="12">
<pre><code>Graduate         3128
High School      2013
Uneducated       1487
College          1013
Post-Graduate     516
Doctorate         451
Name: Education_Level, dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="44"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:472}"
id="NZzA7kmW-uFX" data-outputId="2d3ecefa-b97e-43e2-adfc-e8a596aba542">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualized way</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(data <span class="op">=</span> card_dataset , x<span class="op">=</span>card_dataset.Education_Level , order<span class="op">=</span>card_dataset[<span class="st">&#39;Education_Level&#39;</span>].value_counts().index )</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Education level&#39;</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Count&#39;</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribuion of education level&#39;</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_5aa77c461f9d4ebfbf5ebba86d1cd7c1/6d8a0768d9e74a0c00b1497c09b184fd4b42abc7.png" /></p>
</div>
</div>
<div class="cell markdown" id="HB4gZNNsQ4WF">
<ul>
<li>Majorly Graduates own more credit cards</li>
<li>Doctorates have own less credit cards.</li>
</ul>
</div>
<div class="cell markdown" id="V25dTCGXDM3I">
<p>What is the distribution of the level of income of customers?</p>
</div>
<div class="cell code" data-execution_count="46"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="k-5WEVU8DMr8" data-outputId="e9b905e2-0c91-4ce2-bcbc-3716fc284565">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>card_dataset.Income_Category.value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="46">
<pre><code>Less than $40K    3561
$40K - $60K       1790
$80K - $120K      1535
$60K - $80K       1402
abc               1112
$120K +            727
Name: Income_Category, dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="50"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:664}"
id="cW6JQAB6DLoc" data-outputId="77ec7d82-9d6b-457b-8dc0-c8e34a2d77e2">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>card_dataset , x<span class="op">=</span>card_dataset.Income_Category , order<span class="op">=</span>card_dataset.Income_Category.value_counts().index )</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of Income Category&#39;</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="50">
<pre><code>(array([0, 1, 2, 3, 4, 5]),
 [Text(0, 0, &#39;Less than $40K&#39;),
  Text(1, 0, &#39;$40K - $60K&#39;),
  Text(2, 0, &#39;$80K - $120K&#39;),
  Text(3, 0, &#39;$60K - $80K&#39;),
  Text(4, 0, &#39;abc&#39;),
  Text(5, 0, &#39;$120K +&#39;)])</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_5aa77c461f9d4ebfbf5ebba86d1cd7c1/663c900ff929b9c2f4ede9015558ec8637bf4320.png" /></p>
</div>
</div>
<div class="cell markdown" id="SlCRs8oQRG7S">
<ul>
<li>Majority customers have income &lt; 40k</li>
<li>Who earns &gt; 120k have less number of credit cards.</li>
</ul>
</div>
<div class="cell markdown" id="ry2qrwcbFNDx">
<p>How does the change in transaction amount between Q4 and Q1
(total_ct_change_Q4_Q1) vary by the customer's account status
(Attrition_Flag)?</p>
</div>
<div class="cell code" data-execution_count="4"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:489}"
id="Oxf75EUAFOaT" data-outputId="be4fb939-b171-42f4-916e-473d0910ac75">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparision between Customer Account Staus (Categorical) Vs total_ct_change_Q4_Q1 (Continuous)</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data<span class="op">=</span>card_dataset, x<span class="op">=</span><span class="st">&#39;Attrition_Flag&#39;</span>, y<span class="op">=</span><span class="st">&#39;Total_Ct_Chng_Q4_Q1&#39;</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Account Status (Attrition_Flag)&#39;</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Total Ct Change Q4-Q1&#39;</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Change in Transaction Amount (Total Ct Change Q4-Q1) by Account Status&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="4">
<pre><code>Text(0.5, 1.0, &#39;Change in Transaction Amount (Total Ct Change Q4-Q1) by Account Status&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_5aa77c461f9d4ebfbf5ebba86d1cd7c1/e1afc8f68bf3eb37ec59fa476e94b70f0b7433ff.png" /></p>
</div>
</div>
<div class="cell markdown" id="Qox7EEeZIaxP">
<p>Existing and Attrited customers Total Ct Change Q4-Q1 is almost same
but Existing customers has more outliers.</p>
</div>
<div class="cell markdown" id="RP-ZTnjCHDXC">
<p>How does the number of months a customer was inactive in the last 12
months (Months_Inactive_12_mon) vary by the customer's account status
(Attrition_Flag)?</p>
</div>
<div class="cell code" data-execution_count="9"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:489}"
id="nwSnCRGzIFjt" data-outputId="e656afb2-6591-4a8b-e435-9e47fc5ef544">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data<span class="op">=</span>card_dataset, x<span class="op">=</span><span class="st">&#39;Attrition_Flag&#39;</span>, y<span class="op">=</span><span class="st">&#39;Months_Inactive_12_mon&#39;</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Account Status (Attrition_Flag)&#39;</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Months Inactive in Last 12 Months&#39;</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Inactive Months Variation by Account Status&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="9">
<pre><code>Text(0.5, 1.0, &#39;Inactive Months Variation by Account Status&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_5aa77c461f9d4ebfbf5ebba86d1cd7c1/59fe450e478747ee58a032f1f290f719ebf5ceaa.png" /></p>
</div>
</div>
<div class="cell markdown" id="FGmyUe30IWfk">
<p>Existing customers were typically inactive for around 1-3 months in
the past year. customers who left (attrited) had a slightly higher
inactivity, ranging mostly between 2 and 3 months.</p>
</div>
<div class="cell markdown" id="X4A694MFJLJf">
<p>What are the attributes that have a strong correlation with each
other?</p>
</div>
<div class="cell code" data-execution_count="10"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:574}"
id="Fian11HmHENB" data-outputId="1c018830-24ef-44a5-bcfe-1eea085ff4b8">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="op">=</span> card_dataset.corr()</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>corr_matrix</span></code></pre></div>
<div class="output stream stderr">
<pre><code>&lt;ipython-input-10-a59d05353abc&gt;:1: FutureWarning: The default value of numeric_only in DataFrame.corr is deprecated. In a future version, it will default to False. Select only valid columns or specify the value of numeric_only to silence this warning.
  corr_matrix = card_dataset.corr()
</code></pre>
</div>
<div class="output execute_result" data-execution_count="10">

  <div id="df-fdf170c1-8c3c-4b49-aa46-0855056a1eef" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CLIENTNUM</th>
      <th>Customer_Age</th>
      <th>Dependent_count</th>
      <th>Months_on_book</th>
      <th>Total_Relationship_Count</th>
      <th>Months_Inactive_12_mon</th>
      <th>Contacts_Count_12_mon</th>
      <th>Credit_Limit</th>
      <th>Total_Revolving_Bal</th>
      <th>Avg_Open_To_Buy</th>
      <th>Total_Amt_Chng_Q4_Q1</th>
      <th>Total_Trans_Amt</th>
      <th>Total_Trans_Ct</th>
      <th>Total_Ct_Chng_Q4_Q1</th>
      <th>Avg_Utilization_Ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CLIENTNUM</th>
      <td>1.000000</td>
      <td>0.007613</td>
      <td>0.006772</td>
      <td>0.134588</td>
      <td>0.006907</td>
      <td>0.005729</td>
      <td>0.005694</td>
      <td>0.005708</td>
      <td>0.000825</td>
      <td>0.005633</td>
      <td>0.017369</td>
      <td>-0.019692</td>
      <td>-0.002961</td>
      <td>0.007696</td>
      <td>0.000266</td>
    </tr>
    <tr>
      <th>Customer_Age</th>
      <td>0.007613</td>
      <td>1.000000</td>
      <td>-0.122254</td>
      <td>0.788912</td>
      <td>-0.010931</td>
      <td>0.054361</td>
      <td>-0.018452</td>
      <td>0.002476</td>
      <td>0.014780</td>
      <td>0.001151</td>
      <td>-0.062042</td>
      <td>-0.046446</td>
      <td>-0.067097</td>
      <td>-0.012143</td>
      <td>0.007114</td>
    </tr>
    <tr>
      <th>Dependent_count</th>
      <td>0.006772</td>
      <td>-0.122254</td>
      <td>1.000000</td>
      <td>-0.103062</td>
      <td>-0.039076</td>
      <td>-0.010768</td>
      <td>-0.040505</td>
      <td>0.068065</td>
      <td>-0.002688</td>
      <td>0.068291</td>
      <td>-0.035439</td>
      <td>0.025046</td>
      <td>0.049912</td>
      <td>0.011087</td>
      <td>-0.037135</td>
    </tr>
    <tr>
      <th>Months_on_book</th>
      <td>0.134588</td>
      <td>0.788912</td>
      <td>-0.103062</td>
      <td>1.000000</td>
      <td>-0.009203</td>
      <td>0.074164</td>
      <td>-0.010774</td>
      <td>0.007507</td>
      <td>0.008623</td>
      <td>0.006732</td>
      <td>-0.048959</td>
      <td>-0.038591</td>
      <td>-0.049819</td>
      <td>-0.014072</td>
      <td>-0.007541</td>
    </tr>
    <tr>
      <th>Total_Relationship_Count</th>
      <td>0.006907</td>
      <td>-0.010931</td>
      <td>-0.039076</td>
      <td>-0.009203</td>
      <td>1.000000</td>
      <td>-0.003675</td>
      <td>0.055203</td>
      <td>-0.071386</td>
      <td>0.013726</td>
      <td>-0.072601</td>
      <td>0.050119</td>
      <td>-0.347229</td>
      <td>-0.241891</td>
      <td>0.040831</td>
      <td>0.067663</td>
    </tr>
    <tr>
      <th>Months_Inactive_12_mon</th>
      <td>0.005729</td>
      <td>0.054361</td>
      <td>-0.010768</td>
      <td>0.074164</td>
      <td>-0.003675</td>
      <td>1.000000</td>
      <td>0.029493</td>
      <td>-0.020394</td>
      <td>-0.042210</td>
      <td>-0.016605</td>
      <td>-0.032247</td>
      <td>-0.036982</td>
      <td>-0.042787</td>
      <td>-0.038989</td>
      <td>-0.007503</td>
    </tr>
    <tr>
      <th>Contacts_Count_12_mon</th>
      <td>0.005694</td>
      <td>-0.018452</td>
      <td>-0.040505</td>
      <td>-0.010774</td>
      <td>0.055203</td>
      <td>0.029493</td>
      <td>1.000000</td>
      <td>0.020817</td>
      <td>-0.053913</td>
      <td>0.025646</td>
      <td>-0.024445</td>
      <td>-0.112774</td>
      <td>-0.152213</td>
      <td>-0.094997</td>
      <td>-0.055471</td>
    </tr>
    <tr>
      <th>Credit_Limit</th>
      <td>0.005708</td>
      <td>0.002476</td>
      <td>0.068065</td>
      <td>0.007507</td>
      <td>-0.071386</td>
      <td>-0.020394</td>
      <td>0.020817</td>
      <td>1.000000</td>
      <td>0.042493</td>
      <td>0.995981</td>
      <td>0.012813</td>
      <td>0.171730</td>
      <td>0.075927</td>
      <td>-0.002020</td>
      <td>-0.482965</td>
    </tr>
    <tr>
      <th>Total_Revolving_Bal</th>
      <td>0.000825</td>
      <td>0.014780</td>
      <td>-0.002688</td>
      <td>0.008623</td>
      <td>0.013726</td>
      <td>-0.042210</td>
      <td>-0.053913</td>
      <td>0.042493</td>
      <td>1.000000</td>
      <td>-0.047167</td>
      <td>0.058174</td>
      <td>0.064370</td>
      <td>0.056060</td>
      <td>0.089861</td>
      <td>0.624022</td>
    </tr>
    <tr>
      <th>Avg_Open_To_Buy</th>
      <td>0.005633</td>
      <td>0.001151</td>
      <td>0.068291</td>
      <td>0.006732</td>
      <td>-0.072601</td>
      <td>-0.016605</td>
      <td>0.025646</td>
      <td>0.995981</td>
      <td>-0.047167</td>
      <td>1.000000</td>
      <td>0.007595</td>
      <td>0.165923</td>
      <td>0.070885</td>
      <td>-0.010076</td>
      <td>-0.538808</td>
    </tr>
    <tr>
      <th>Total_Amt_Chng_Q4_Q1</th>
      <td>0.017369</td>
      <td>-0.062042</td>
      <td>-0.035439</td>
      <td>-0.048959</td>
      <td>0.050119</td>
      <td>-0.032247</td>
      <td>-0.024445</td>
      <td>0.012813</td>
      <td>0.058174</td>
      <td>0.007595</td>
      <td>1.000000</td>
      <td>0.039678</td>
      <td>0.005469</td>
      <td>0.384189</td>
      <td>0.035235</td>
    </tr>
    <tr>
      <th>Total_Trans_Amt</th>
      <td>-0.019692</td>
      <td>-0.046446</td>
      <td>0.025046</td>
      <td>-0.038591</td>
      <td>-0.347229</td>
      <td>-0.036982</td>
      <td>-0.112774</td>
      <td>0.171730</td>
      <td>0.064370</td>
      <td>0.165923</td>
      <td>0.039678</td>
      <td>1.000000</td>
      <td>0.807192</td>
      <td>0.085581</td>
      <td>-0.083034</td>
    </tr>
    <tr>
      <th>Total_Trans_Ct</th>
      <td>-0.002961</td>
      <td>-0.067097</td>
      <td>0.049912</td>
      <td>-0.049819</td>
      <td>-0.241891</td>
      <td>-0.042787</td>
      <td>-0.152213</td>
      <td>0.075927</td>
      <td>0.056060</td>
      <td>0.070885</td>
      <td>0.005469</td>
      <td>0.807192</td>
      <td>1.000000</td>
      <td>0.112324</td>
      <td>0.002838</td>
    </tr>
    <tr>
      <th>Total_Ct_Chng_Q4_Q1</th>
      <td>0.007696</td>
      <td>-0.012143</td>
      <td>0.011087</td>
      <td>-0.014072</td>
      <td>0.040831</td>
      <td>-0.038989</td>
      <td>-0.094997</td>
      <td>-0.002020</td>
      <td>0.089861</td>
      <td>-0.010076</td>
      <td>0.384189</td>
      <td>0.085581</td>
      <td>0.112324</td>
      <td>1.000000</td>
      <td>0.074143</td>
    </tr>
    <tr>
      <th>Avg_Utilization_Ratio</th>
      <td>0.000266</td>
      <td>0.007114</td>
      <td>-0.037135</td>
      <td>-0.007541</td>
      <td>0.067663</td>
      <td>-0.007503</td>
      <td>-0.055471</td>
      <td>-0.482965</td>
      <td>0.624022</td>
      <td>-0.538808</td>
      <td>0.035235</td>
      <td>-0.083034</td>
      <td>0.002838</td>
      <td>0.074143</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-fdf170c1-8c3c-4b49-aa46-0855056a1eef')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-fdf170c1-8c3c-4b49-aa46-0855056a1eef button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-fdf170c1-8c3c-4b49-aa46-0855056a1eef');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-cce601ca-f62f-496e-ad4c-a656b88ff984">
  <button class="colab-df-quickchart" onclick="quickchart('df-cce601ca-f62f-496e-ad4c-a656b88ff984')"
            title="Suggest charts."
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-cce601ca-f62f-496e-ad4c-a656b88ff984 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="11"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:630}"
id="eY9UbaSnJZOc" data-outputId="0eef5c88-fae3-4ff9-bb8f-8f2e063259d4">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>sns.heatmap(corr_matrix)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Correlation Heatmap&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="11">
<pre><code>Text(0.5, 1.0, &#39;Correlation Heatmap&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_5aa77c461f9d4ebfbf5ebba86d1cd7c1/e5a87f744e225c72f4dc0b77abd5fad7542333b0.png" /></p>
</div>
</div>
<div class="cell markdown" id="QFhq3ofjKRt6">
<ul>
<li><p>"Total_Trans_Amt" and "Total_Trans_Ct" have a high positive
correlation</p></li>
<li><p>"Avg_Open_To_Buy" and "Credit_Limit" also show a high positive
correlation.</p></li>
<li><p>"Total_Revolving_Bal" and "Avg_Utilization_Ratio" are strongly
positively correlated.</p></li>
</ul>
</div>
<section id="data-pre-processing" class="cell markdown"
id="knk0w9XH4jao">
<h2>Data Pre-processing</h2>
</section>
<div class="cell markdown" id="6V3xB8b1ewfe">
<p>Convert Categorical values into numerical values using Lable &amp;
One Hot encoding</p>
</div>
<div class="cell code" data-execution_count="37"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="2JbJc1bX4jao" data-outputId="7765adb6-4872-4f21-dc0e-424b0470f998">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert `Attrition_Flag` as lable Encoder</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>lableEncoder <span class="op">=</span> LabelEncoder()</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>card_dataset.Attrition_Flag <span class="op">=</span> lableEncoder.fit_transform(card_dataset.Attrition_Flag)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>card_dataset.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 10127 entries, 0 to 10126
Data columns (total 21 columns):
 #   Column                    Non-Null Count  Dtype  
---  ------                    --------------  -----  
 0   CLIENTNUM                 10127 non-null  int64  
 1   Attrition_Flag            10127 non-null  int64  
 2   Customer_Age              10127 non-null  int64  
 3   Gender                    10127 non-null  object 
 4   Dependent_count           10127 non-null  int64  
 5   Education_Level           8608 non-null   object 
 6   Marital_Status            9378 non-null   object 
 7   Income_Category           10127 non-null  object 
 8   Card_Category             10127 non-null  object 
 9   Months_on_book            10127 non-null  int64  
 10  Total_Relationship_Count  10127 non-null  int64  
 11  Months_Inactive_12_mon    10127 non-null  int64  
 12  Contacts_Count_12_mon     10127 non-null  int64  
 13  Credit_Limit              10127 non-null  float64
 14  Total_Revolving_Bal       10127 non-null  int64  
 15  Avg_Open_To_Buy           10127 non-null  float64
 16  Total_Amt_Chng_Q4_Q1      10127 non-null  float64
 17  Total_Trans_Amt           10127 non-null  int64  
 18  Total_Trans_Ct            10127 non-null  int64  
 19  Total_Ct_Chng_Q4_Q1       10127 non-null  float64
 20  Avg_Utilization_Ratio     10127 non-null  float64
dtypes: float64(5), int64(11), object(5)
memory usage: 1.6+ MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="44"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:461}"
id="crqpBlBxgT0m" data-outputId="e16b58ca-fd8e-46f3-a09d-93330c590e73">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use pandas&#39; get_dummies function for one-hot encoding</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>categorical_columns <span class="op">=</span> [<span class="st">&#39;Gender&#39;</span>, <span class="st">&#39;Education_Level&#39;</span> , <span class="st">&#39;Marital_Status&#39;</span> , <span class="st">&#39;Income_Category&#39;</span> , <span class="st">&#39;Card_Category&#39;</span>   ]</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>encoded_card_dataset <span class="op">=</span> pd.get_dummies(data<span class="op">=</span>card_dataset , columns<span class="op">=</span> categorical_columns , prefix<span class="op">=</span>categorical_columns , drop_first<span class="op">=</span><span class="va">True</span> )</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>encoded_card_dataset</span></code></pre></div>
<div class="output execute_result" data-execution_count="44">

  <div id="df-b2b595c7-87c1-4433-995a-33e76b036212" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CLIENTNUM</th>
      <th>Attrition_Flag</th>
      <th>Customer_Age</th>
      <th>Dependent_count</th>
      <th>Months_on_book</th>
      <th>Total_Relationship_Count</th>
      <th>Months_Inactive_12_mon</th>
      <th>Contacts_Count_12_mon</th>
      <th>Credit_Limit</th>
      <th>Total_Revolving_Bal</th>
      <th>...</th>
      <th>Marital_Status_Married</th>
      <th>Marital_Status_Single</th>
      <th>Income_Category_$40K - $60K</th>
      <th>Income_Category_$60K - $80K</th>
      <th>Income_Category_$80K - $120K</th>
      <th>Income_Category_Less than $40K</th>
      <th>Income_Category_abc</th>
      <th>Card_Category_Gold</th>
      <th>Card_Category_Platinum</th>
      <th>Card_Category_Silver</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>768805383</td>
      <td>1</td>
      <td>45</td>
      <td>3</td>
      <td>39</td>
      <td>5</td>
      <td>1</td>
      <td>3</td>
      <td>12691.0</td>
      <td>777</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>818770008</td>
      <td>1</td>
      <td>49</td>
      <td>5</td>
      <td>44</td>
      <td>6</td>
      <td>1</td>
      <td>2</td>
      <td>8256.0</td>
      <td>864</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>713982108</td>
      <td>1</td>
      <td>51</td>
      <td>3</td>
      <td>36</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>3418.0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>769911858</td>
      <td>1</td>
      <td>40</td>
      <td>4</td>
      <td>34</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>3313.0</td>
      <td>2517</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>709106358</td>
      <td>1</td>
      <td>40</td>
      <td>3</td>
      <td>21</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>4716.0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>10122</th>
      <td>772366833</td>
      <td>1</td>
      <td>50</td>
      <td>2</td>
      <td>40</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>4003.0</td>
      <td>1851</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10123</th>
      <td>710638233</td>
      <td>0</td>
      <td>41</td>
      <td>2</td>
      <td>25</td>
      <td>4</td>
      <td>2</td>
      <td>3</td>
      <td>4277.0</td>
      <td>2186</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10124</th>
      <td>716506083</td>
      <td>0</td>
      <td>44</td>
      <td>1</td>
      <td>36</td>
      <td>5</td>
      <td>3</td>
      <td>4</td>
      <td>5409.0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10125</th>
      <td>717406983</td>
      <td>0</td>
      <td>30</td>
      <td>2</td>
      <td>36</td>
      <td>4</td>
      <td>3</td>
      <td>3</td>
      <td>5281.0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10126</th>
      <td>714337233</td>
      <td>0</td>
      <td>43</td>
      <td>2</td>
      <td>25</td>
      <td>6</td>
      <td>2</td>
      <td>4</td>
      <td>10388.0</td>
      <td>1961</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>10127 rows × 32 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b2b595c7-87c1-4433-995a-33e76b036212')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b2b595c7-87c1-4433-995a-33e76b036212 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b2b595c7-87c1-4433-995a-33e76b036212');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-dbf6db6f-fda7-4f55-9585-4ea39cfcaa4a">
  <button class="colab-df-quickchart" onclick="quickchart('df-dbf6db6f-fda7-4f55-9585-4ea39cfcaa4a')"
            title="Suggest charts."
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-dbf6db6f-fda7-4f55-9585-4ea39cfcaa4a button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="45"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="7e3WFSwFh-rV" data-outputId="4805ae0f-5d00-4689-aa22-bab3b3edd500">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>encoded_card_dataset.describe().T</span></code></pre></div>
<div class="output execute_result" data-execution_count="45">

  <div id="df-9ba2bfe9-b20a-453b-a824-a23e01c2950a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CLIENTNUM</th>
      <td>10127.0</td>
      <td>7.391776e+08</td>
      <td>3.690378e+07</td>
      <td>708082083.0</td>
      <td>7.130368e+08</td>
      <td>7.179264e+08</td>
      <td>7.731435e+08</td>
      <td>8.283431e+08</td>
    </tr>
    <tr>
      <th>Attrition_Flag</th>
      <td>10127.0</td>
      <td>8.393404e-01</td>
      <td>3.672348e-01</td>
      <td>0.0</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>Customer_Age</th>
      <td>10127.0</td>
      <td>4.632596e+01</td>
      <td>8.016814e+00</td>
      <td>26.0</td>
      <td>4.100000e+01</td>
      <td>4.600000e+01</td>
      <td>5.200000e+01</td>
      <td>7.300000e+01</td>
    </tr>
    <tr>
      <th>Dependent_count</th>
      <td>10127.0</td>
      <td>2.346203e+00</td>
      <td>1.298908e+00</td>
      <td>0.0</td>
      <td>1.000000e+00</td>
      <td>2.000000e+00</td>
      <td>3.000000e+00</td>
      <td>5.000000e+00</td>
    </tr>
    <tr>
      <th>Months_on_book</th>
      <td>10127.0</td>
      <td>3.592841e+01</td>
      <td>7.986416e+00</td>
      <td>13.0</td>
      <td>3.100000e+01</td>
      <td>3.600000e+01</td>
      <td>4.000000e+01</td>
      <td>5.600000e+01</td>
    </tr>
    <tr>
      <th>Total_Relationship_Count</th>
      <td>10127.0</td>
      <td>3.812580e+00</td>
      <td>1.554408e+00</td>
      <td>1.0</td>
      <td>3.000000e+00</td>
      <td>4.000000e+00</td>
      <td>5.000000e+00</td>
      <td>6.000000e+00</td>
    </tr>
    <tr>
      <th>Months_Inactive_12_mon</th>
      <td>10127.0</td>
      <td>2.341167e+00</td>
      <td>1.010622e+00</td>
      <td>0.0</td>
      <td>2.000000e+00</td>
      <td>2.000000e+00</td>
      <td>3.000000e+00</td>
      <td>6.000000e+00</td>
    </tr>
    <tr>
      <th>Contacts_Count_12_mon</th>
      <td>10127.0</td>
      <td>2.455317e+00</td>
      <td>1.106225e+00</td>
      <td>0.0</td>
      <td>2.000000e+00</td>
      <td>2.000000e+00</td>
      <td>3.000000e+00</td>
      <td>6.000000e+00</td>
    </tr>
    <tr>
      <th>Credit_Limit</th>
      <td>10127.0</td>
      <td>8.631954e+03</td>
      <td>9.088777e+03</td>
      <td>1438.3</td>
      <td>2.555000e+03</td>
      <td>4.549000e+03</td>
      <td>1.106750e+04</td>
      <td>3.451600e+04</td>
    </tr>
    <tr>
      <th>Total_Revolving_Bal</th>
      <td>10127.0</td>
      <td>1.162814e+03</td>
      <td>8.149873e+02</td>
      <td>0.0</td>
      <td>3.590000e+02</td>
      <td>1.276000e+03</td>
      <td>1.784000e+03</td>
      <td>2.517000e+03</td>
    </tr>
    <tr>
      <th>Avg_Open_To_Buy</th>
      <td>10127.0</td>
      <td>7.469140e+03</td>
      <td>9.090685e+03</td>
      <td>3.0</td>
      <td>1.324500e+03</td>
      <td>3.474000e+03</td>
      <td>9.859000e+03</td>
      <td>3.451600e+04</td>
    </tr>
    <tr>
      <th>Total_Amt_Chng_Q4_Q1</th>
      <td>10127.0</td>
      <td>7.599407e-01</td>
      <td>2.192068e-01</td>
      <td>0.0</td>
      <td>6.310000e-01</td>
      <td>7.360000e-01</td>
      <td>8.590000e-01</td>
      <td>3.397000e+00</td>
    </tr>
    <tr>
      <th>Total_Trans_Amt</th>
      <td>10127.0</td>
      <td>4.404086e+03</td>
      <td>3.397129e+03</td>
      <td>510.0</td>
      <td>2.155500e+03</td>
      <td>3.899000e+03</td>
      <td>4.741000e+03</td>
      <td>1.848400e+04</td>
    </tr>
    <tr>
      <th>Total_Trans_Ct</th>
      <td>10127.0</td>
      <td>6.485869e+01</td>
      <td>2.347257e+01</td>
      <td>10.0</td>
      <td>4.500000e+01</td>
      <td>6.700000e+01</td>
      <td>8.100000e+01</td>
      <td>1.390000e+02</td>
    </tr>
    <tr>
      <th>Total_Ct_Chng_Q4_Q1</th>
      <td>10127.0</td>
      <td>7.122224e-01</td>
      <td>2.380861e-01</td>
      <td>0.0</td>
      <td>5.820000e-01</td>
      <td>7.020000e-01</td>
      <td>8.180000e-01</td>
      <td>3.714000e+00</td>
    </tr>
    <tr>
      <th>Avg_Utilization_Ratio</th>
      <td>10127.0</td>
      <td>2.748936e-01</td>
      <td>2.756915e-01</td>
      <td>0.0</td>
      <td>2.300000e-02</td>
      <td>1.760000e-01</td>
      <td>5.030000e-01</td>
      <td>9.990000e-01</td>
    </tr>
    <tr>
      <th>Gender_M</th>
      <td>10127.0</td>
      <td>4.709193e-01</td>
      <td>4.991782e-01</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>Education_Level_Doctorate</th>
      <td>10127.0</td>
      <td>4.453441e-02</td>
      <td>2.062894e-01</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>Education_Level_Graduate</th>
      <td>10127.0</td>
      <td>3.088773e-01</td>
      <td>4.620532e-01</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>Education_Level_High School</th>
      <td>10127.0</td>
      <td>1.987756e-01</td>
      <td>3.990984e-01</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>Education_Level_Post-Graduate</th>
      <td>10127.0</td>
      <td>5.095290e-02</td>
      <td>2.199124e-01</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>Education_Level_Uneducated</th>
      <td>10127.0</td>
      <td>1.468352e-01</td>
      <td>3.539590e-01</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>Marital_Status_Married</th>
      <td>10127.0</td>
      <td>4.628222e-01</td>
      <td>4.986405e-01</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>Marital_Status_Single</th>
      <td>10127.0</td>
      <td>3.893552e-01</td>
      <td>4.876281e-01</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>Income_Category_$40K - $60K</th>
      <td>10127.0</td>
      <td>1.767552e-01</td>
      <td>3.814802e-01</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>Income_Category_$60K - $80K</th>
      <td>10127.0</td>
      <td>1.384418e-01</td>
      <td>3.453801e-01</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>Income_Category_$80K - $120K</th>
      <td>10127.0</td>
      <td>1.515750e-01</td>
      <td>3.586262e-01</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>Income_Category_Less than $40K</th>
      <td>10127.0</td>
      <td>3.516342e-01</td>
      <td>4.775041e-01</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>Income_Category_abc</th>
      <td>10127.0</td>
      <td>1.098055e-01</td>
      <td>3.126626e-01</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>Card_Category_Gold</th>
      <td>10127.0</td>
      <td>1.145453e-02</td>
      <td>1.064163e-01</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>Card_Category_Platinum</th>
      <td>10127.0</td>
      <td>1.974919e-03</td>
      <td>4.439834e-02</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>Card_Category_Silver</th>
      <td>10127.0</td>
      <td>5.480399e-02</td>
      <td>2.276085e-01</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9ba2bfe9-b20a-453b-a824-a23e01c2950a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9ba2bfe9-b20a-453b-a824-a23e01c2950a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9ba2bfe9-b20a-453b-a824-a23e01c2950a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-0d6bda48-4189-4b97-8abc-53fb4dcc4ee7">
  <button class="colab-df-quickchart" onclick="quickchart('df-0d6bda48-4189-4b97-8abc-53fb4dcc4ee7')"
            title="Suggest charts."
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-0d6bda48-4189-4b97-8abc-53fb4dcc4ee7 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="9fV_dZZIiHcc">
<p>Apply Feature Scaling for continuous columns</p>
</div>
<div class="cell code" data-execution_count="48" id="MZG1KmAGiPUz">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>scaling_columns <span class="op">=</span> [</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Customer_Age&#39;</span>,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Months_on_book&#39;</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Total_Relationship_Count&#39;</span>,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Months_Inactive_12_mon&#39;</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Contacts_Count_12_mon&#39;</span>,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Total_Trans_Ct&#39;</span>,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Total_Ct_Chng_Q4_Q1&#39;</span>,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Credit_Limit&#39;</span>,</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Total_Revolving_Bal&#39;</span>,</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Avg_Open_To_Buy&#39;</span>,</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Total_Amt_Chng_Q4_Q1&#39;</span>,</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Total_Trans_Amt&#39;</span>,</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Avg_Utilization_Ratio&#39;</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>minMaxScaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>encoded_card_dataset[scaling_columns] <span class="op">=</span> minMaxScaler.fit_transform(encoded_card_dataset[scaling_columns])</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>scaled_card_dataset<span class="op">=</span>encoded_card_dataset</span></code></pre></div>
</div>
<section id="missing-value-imputation" class="cell markdown"
id="0J99-7Kubp09">
<h2>Missing value imputation</h2>
</section>
<div class="cell code" data-execution_count="54"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="hke9uYOfBqoQ" data-outputId="7d118ace-c64f-4ab9-b49c-798d5f313824">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage of missing values in each column</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>scaled_card_dataset.isnull().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="54">
<pre><code>CLIENTNUM                         0
Attrition_Flag                    0
Customer_Age                      0
Dependent_count                   0
Months_on_book                    0
Total_Relationship_Count          0
Months_Inactive_12_mon            0
Contacts_Count_12_mon             0
Credit_Limit                      0
Total_Revolving_Bal               0
Avg_Open_To_Buy                   0
Total_Amt_Chng_Q4_Q1              0
Total_Trans_Amt                   0
Total_Trans_Ct                    0
Total_Ct_Chng_Q4_Q1               0
Avg_Utilization_Ratio             0
Gender_M                          0
Education_Level_Doctorate         0
Education_Level_Graduate          0
Education_Level_High School       0
Education_Level_Post-Graduate     0
Education_Level_Uneducated        0
Marital_Status_Married            0
Marital_Status_Single             0
Income_Category_$40K - $60K       0
Income_Category_$60K - $80K       0
Income_Category_$80K - $120K      0
Income_Category_Less than $40K    0
Income_Category_abc               0
Card_Category_Gold                0
Card_Category_Platinum            0
Card_Category_Silver              0
dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown" id="mQpAsYyiMEEc">
<p>As there are no missing values , Ignoring imputation step</p>
</div>
<section id="model-building" class="cell markdown" id="OzOa9FGA6WtG">
<h2>Model Building</h2>
</section>
<section id="model-evaluation-criterion" class="cell markdown"
id="YZqmoqz7bp0-">
<h3>Model evaluation criterion</h3>
</section>
<div class="cell markdown" id="l2ORUgmUjDZC">
<p>The nature of predictions made by the classification model will
translate as follows:</p>
<ul>
<li>True positives (TP) are failures correctly predicted by the
model.</li>
<li>False negatives (FN) are real failures in a generator where there is
no detection by model.</li>
<li>False positives (FP) are failure detections in a generator where
there is no failure.</li>
</ul>
<p><strong>Which metric to optimize?</strong></p>
<ul>
<li>We need to choose the metric which will ensure that the maximum
number of generator failures are predicted correctly by the model.</li>
<li>We would want Recall to be maximized as greater the Recall, the
higher the chances of minimizing false negatives.</li>
<li>We want to minimize false negatives because if a model predicts that
a machine will have no failure when there will be a failure, it will
increase the maintenance cost.</li>
</ul>
</div>
<div class="cell markdown" id="djQTqGKU4jap">
<p><strong>Let's define a function to output different metrics
(including recall) on the train and test set and a function to show
confusion matrix so that we do not have to use the same code
repetitively while evaluating models.</strong></p>
</div>
<div class="cell code" data-execution_count="50" id="bIekBxwp4jaq">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># defining a function to compute different metrics to check performance of a classification model built using sklearn</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> precision_score , recall_score , accuracy_score , f1_score</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> model_performance_classification_sklearn(model, predictors, target):</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Function to compute different metrics to check classification model performance</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co">    model: classifier</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co">    predictors: independent variables</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co">    target: dependent variable</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># predicting using the independent variables</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    pred <span class="op">=</span> model.predict(predictors)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    acc <span class="op">=</span> accuracy_score(target, pred)  <span class="co"># to compute Accuracy</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>    recall <span class="op">=</span> recall_score(target, pred)  <span class="co"># to compute Recall</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    precision <span class="op">=</span> precision_score(target, pred)  <span class="co"># to compute Precision</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    f1 <span class="op">=</span> f1_score(target, pred)  <span class="co"># to compute F1-score</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># creating a dataframe of metrics</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>    df_perf <span class="op">=</span> pd.DataFrame(</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Accuracy&quot;</span>: acc,</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Recall&quot;</span>: recall,</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Precision&quot;</span>: precision,</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;F1&quot;</span>: f1</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>        index<span class="op">=</span>[<span class="dv">0</span>],</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df_perf</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
</div>
<section id="model-building-with-original-data" class="cell markdown"
id="eqCDCbcw4jas">
<h3>Model Building with original data</h3>
</section>
<div class="cell markdown" id="dBtuhurlhKyp">
<p>Sample code for model building with original data</p>
</div>
<div class="cell code" data-execution_count="59"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="V-tpzI7g4jas" data-outputId="93d35ed3-163c-4990-b922-2a70669f08cf">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> BaggingClassifier , RandomForestClassifier</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> AdaBoostClassifier , GradientBoostingClassifier</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xgboost <span class="im">import</span> XGBClassifier</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> []  <span class="co"># Empty list to store all the models</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Appending models into the list</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>models.append((<span class="st">&quot;Bagging&quot;</span>, BaggingClassifier(random_state<span class="op">=</span><span class="dv">1</span>)))</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>models.append((<span class="st">&quot;Random forest&quot;</span>, RandomForestClassifier(random_state<span class="op">=</span><span class="dv">1</span>)))</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>models.append((<span class="st">&quot;AdaBoost&quot;</span> , AdaBoostClassifier(random_state<span class="op">=</span><span class="dv">1</span>)))</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>models.append((<span class="st">&quot;GraidentBoost&quot;</span> , GradientBoostingClassifier(random_state<span class="op">=</span><span class="dv">1</span>)))</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>models.append((<span class="st">&quot;XGBoost&quot;</span> , XGBClassifier(random_state<span class="op">=</span><span class="dv">1</span>)))</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> scaled_card_dataset.drop(columns<span class="op">=</span>[<span class="st">&#39;Attrition_Flag&#39;</span>])</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> scaled_card_dataset.Attrition_Flag</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the dataset into training and validation sets</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>X_train, X_val, y_train, y_val <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">1</span>)  <span class="co"># Here, 30% of the data is set aside for validation</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span> <span class="st">&quot;Training Performance:&quot;</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, model <span class="kw">in</span> models:</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>    model.fit(X_train, y_train)</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>    recall_scores <span class="op">=</span> recall_score(y_train, model.predict(X_train))</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>    f1_scores <span class="op">=</span> f1_score(y_train, model.predict(X_train))</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="sc">{}</span><span class="st">: </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(name, recall_scores))</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="sc">{}</span><span class="st">: </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(name, f1_scores))</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span> <span class="st">&quot;Validation Performance:&quot;</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, model <span class="kw">in</span> models:</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>    model.fit(X_train, y_train)</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>    scores_val <span class="op">=</span> recall_score(y_val, model.predict(X_val))</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="sc">{}</span><span class="st">: </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(name, scores_val))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>
Training Performance:

Bagging: 0.9976466633047572
Random forest: 1.0
AdaBoost: 0.9836947386115313
GraidentBoost: 0.992603798957808
XGBoost: 1.0

Validation Performance:

Bagging: 0.9788318306546452
Random forest: 0.9858878871030968
AdaBoost: 0.9796158369266954
GraidentBoost: 0.9890239121912975
XGBoost: 0.9886319090552724
</code></pre>
</div>
</div>
<section id="model-building-with-oversampled-data" class="cell markdown"
id="oBKJaFU24jas">
<h3>Model Building with Oversampled data</h3>
</section>
<div class="cell code" id="FKxnygkE4jat">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Synthetic Minority Over Sampling Technique</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>sm <span class="op">=</span> SMOTE(k_neighbors<span class="op">=</span><span class="dv">5</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>X_train_over, y_train_over <span class="op">=</span> sm.fit_resample(X_train, y_train)</span></code></pre></div>
</div>
<section id="model-building-with-undersampled-data"
class="cell markdown" id="1aimb6bn4jat">
<h3>Model Building with Undersampled data</h3>
</section>
<div class="cell code" data-execution_count="61" id="DhxfTkvu4jat">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Random undersampler for under sampling the data</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.under_sampling <span class="im">import</span> RandomUnderSampler</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>rus <span class="op">=</span> RandomUnderSampler(random_state<span class="op">=</span><span class="dv">1</span>, sampling_strategy<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>X_train_un, y_train_un <span class="op">=</span> rus.fit_resample(X_train, y_train)</span></code></pre></div>
</div>
<section id="hyperparametertuning" class="cell markdown"
id="yZGY1eL84jau">
<h3>HyperparameterTuning</h3>
</section>
<section id="sample-parameter-grids" class="cell markdown"
id="rxM3jQuK_Pqc">
<h4>Sample Parameter Grids</h4>
</section>
<div class="cell markdown" id="czq7BZ5b4jau">
<p><strong>Hyperparameter tuning can take a long time to run, so to
avoid that time complexity - you can use the following grids, wherever
required.</strong></p>
<ul>
<li>For Gradient Boosting:</li>
</ul>
<pre><code>param_grid = {
    &quot;init&quot;: [AdaBoostClassifier(random_state=1),DecisionTreeClassifier(random_state=1)],
    &quot;n_estimators&quot;: np.arange(75,150,25),
    &quot;learning_rate&quot;: [0.1, 0.01, 0.2, 0.05, 1],
    &quot;subsample&quot;:[0.5,0.7,1],
    &quot;max_features&quot;:[0.5,0.7,1],
}</code></pre>
<ul>
<li>For Adaboost:</li>
</ul>
<pre><code>param_grid = {
     &quot;n_estimators&quot;: np.arange(10, 110, 10),
     &quot;learning_rate&quot;: [0.1, 0.01, 0.2, 0.05, 1],
     &quot;base_estimator&quot;: [
         DecisionTreeClassifier(max_depth=1, random_state=1),
         DecisionTreeClassifier(max_depth=2, random_state=1),
         DecisionTreeClassifier(max_depth=3, random_state=1),
    ]
}</code></pre>
<ul>
<li>For Bagging Classifier:</li>
</ul>
<pre><code>param_grid = {
    &#39;max_samples&#39;: [0.8,0.9,1],
    &#39;max_features&#39;: [0.7,0.8,0.9],
    &#39;n_estimators&#39; : [30,50,70],
}</code></pre>
<ul>
<li>For Random Forest:</li>
</ul>
<pre><code>param_grid = {
    &quot;n_estimators&quot;: [200,250,300],
    &quot;min_samples_leaf&quot;: np.arange(1, 4),
    &quot;max_features&quot;: [np.arange(0.3, 0.6, 0.1),&#39;sqrt&#39;],
    &quot;max_samples&quot;: np.arange(0.4, 0.7, 0.1)
}</code></pre>
<ul>
<li>For Decision Trees:</li>
</ul>
<pre><code>param_grid = {
    &#39;max_depth&#39;: np.arange(2,6),
    &#39;min_samples_leaf&#39;: [1, 4, 7],
    &#39;max_leaf_nodes&#39; : [10, 15],
    &#39;min_impurity_decrease&#39;: [0.0001,0.001]
}</code></pre>
<ul>
<li>For XGBoost:</li>
</ul>
<pre><code>param_grid={
   &#39;n_estimators&#39;:np.arange(50,300,50),
   &#39;scale_pos_weight&#39;:[0,1,2,5,10],
   &#39;learning_rate&#39;:[0.01,0.1,0.2,0.05],
   &#39;gamma&#39;:[0,1,3,5],
   &#39;subsample&#39;:[0.7,0.8,0.9,1]
}</code></pre>
</div>
<div class="cell code" id="tG249UG2dRnj">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># defining model</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> RandomizedSearchCV</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> AdaBoostClassifier , BaggingClassifier , RandomForestClassifier</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>decisionTreeModel <span class="op">=</span> DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter grid to pass in RandomSearchCV</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>decisionTree_param_grid <span class="op">=</span> {<span class="st">&#39;max_depth&#39;</span>: np.arange(<span class="dv">2</span>,<span class="dv">6</span>),</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;min_samples_leaf&#39;</span>: [<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>],</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;max_leaf_nodes&#39;</span> : [<span class="dv">10</span>,<span class="dv">15</span>],</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;min_impurity_decrease&#39;</span>: [<span class="fl">0.0001</span>,<span class="fl">0.001</span>] }</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>GBMTreeModel <span class="op">=</span> GradientBoostingClassifier(random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter grid to pass in RandomSearchCV</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>gbm_param_grid <span class="op">=</span> {</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;init&quot;</span>: [AdaBoostClassifier(random_state<span class="op">=</span><span class="dv">1</span>),DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">1</span>)],</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;n_estimators&quot;</span>: np.arange(<span class="dv">75</span>,<span class="dv">150</span>,<span class="dv">25</span>),</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;learning_rate&quot;</span>: [<span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.2</span>, <span class="fl">0.05</span>, <span class="dv">1</span>],</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;subsample&quot;</span>:[<span class="fl">0.5</span>,<span class="fl">0.7</span>,<span class="dv">1</span>],</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;max_features&quot;</span>:[<span class="fl">0.5</span>,<span class="fl">0.7</span>,<span class="dv">1</span>],</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>                      }</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>adaBoostModel <span class="op">=</span> AdaBoostClassifier(random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter grid to pass in RandomSearchCV</span></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>adaboost_param_grid <span class="op">=</span> {</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;n_estimators&quot;</span>: np.arange(<span class="dv">10</span>, <span class="dv">110</span>, <span class="dv">10</span>),</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;learning_rate&quot;</span>: [<span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.2</span>, <span class="fl">0.05</span>, <span class="dv">1</span>],</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;estimator&quot;</span>: [</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>                        DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">1</span>, random_state<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>                        DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">2</span>, random_state<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>                        DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">3</span>, random_state<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>                    ]</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>baggingModel <span class="op">=</span> BaggingClassifier(random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter grid to pass in RandomSearchCV</span></span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>bagging_param_grid <span class="op">=</span> {</span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;max_samples&#39;</span>: [<span class="fl">0.8</span>,<span class="fl">0.9</span>,<span class="dv">1</span>],</span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;max_features&#39;</span>: [<span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.9</span>],</span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;n_estimators&#39;</span> : [<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">70</span>],</span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a>randomForestModel <span class="op">=</span> RandomForestClassifier(random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter grid to pass in RandomSearchCV</span></span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a>randomforest_param_grid <span class="op">=</span> {</span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;n_estimators&quot;</span>: [<span class="dv">200</span>,<span class="dv">250</span>,<span class="dv">300</span>],</span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;min_samples_leaf&quot;</span>: np.arange(<span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;max_features&quot;</span>: [np.arange(<span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="fl">0.1</span>),<span class="st">&#39;sqrt&#39;</span>],</span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;max_samples&quot;</span>: np.arange(<span class="fl">0.4</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span>)</span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a>              }</span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-56"><a href="#cb51-56" aria-hidden="true" tabindex="-1"></a>randomForestModel <span class="op">=</span> XGBClassifier(random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb51-57"><a href="#cb51-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter grid to pass in RandomSearchCV</span></span>
<span id="cb51-58"><a href="#cb51-58" aria-hidden="true" tabindex="-1"></a>xgboost_param_grid <span class="op">=</span> {</span>
<span id="cb51-59"><a href="#cb51-59" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;n_estimators&quot;</span>: np.arange(<span class="dv">10</span>, <span class="dv">110</span>, <span class="dv">10</span>),</span>
<span id="cb51-60"><a href="#cb51-60" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;learning_rate&quot;</span>: [<span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.2</span>, <span class="fl">0.05</span>, <span class="dv">1</span>],</span>
<span id="cb51-61"><a href="#cb51-61" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;base_estimator&quot;</span>: [</span>
<span id="cb51-62"><a href="#cb51-62" aria-hidden="true" tabindex="-1"></a>                    DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">1</span>, random_state<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb51-63"><a href="#cb51-63" aria-hidden="true" tabindex="-1"></a>                    DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">2</span>, random_state<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb51-64"><a href="#cb51-64" aria-hidden="true" tabindex="-1"></a>                    DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">3</span>, random_state<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb51-65"><a href="#cb51-65" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb51-66"><a href="#cb51-66" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb51-67"><a href="#cb51-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-68"><a href="#cb51-68" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> [</span>
<span id="cb51-69"><a href="#cb51-69" aria-hidden="true" tabindex="-1"></a>            {<span class="st">&#39;modelname&#39;</span>:<span class="st">&#39;DecisionTreeModel&#39;</span> , <span class="st">&#39;model_obj&#39;</span>:decisionTreeModel , <span class="st">&#39;param_values&#39;</span> :decisionTree_param_grid} ,</span>
<span id="cb51-70"><a href="#cb51-70" aria-hidden="true" tabindex="-1"></a>            {<span class="st">&#39;modelname&#39;</span>:<span class="st">&#39;GBMModel&#39;</span> , <span class="st">&#39;model_obj&#39;</span>:GBMTreeModel , <span class="st">&#39;param_values&#39;</span> :gbm_param_grid},</span>
<span id="cb51-71"><a href="#cb51-71" aria-hidden="true" tabindex="-1"></a>            {<span class="st">&#39;modelname&#39;</span>:<span class="st">&#39;AdaBoost&#39;</span> , <span class="st">&#39;model_obj&#39;</span>:adaBoostModel , <span class="st">&#39;param_values&#39;</span> :adaboost_param_grid},</span>
<span id="cb51-72"><a href="#cb51-72" aria-hidden="true" tabindex="-1"></a>            {<span class="st">&#39;modelname&#39;</span>:<span class="st">&#39;BaggingModel&#39;</span> , <span class="st">&#39;model_obj&#39;</span>:baggingModel , <span class="st">&#39;param_values&#39;</span> :bagging_param_grid},</span>
<span id="cb51-73"><a href="#cb51-73" aria-hidden="true" tabindex="-1"></a>            <span class="co"># # {&#39;modelname&#39;:&#39;RandomForest&#39; , &#39;model_obj&#39;:randomForestModel , &#39;param_values&#39; :randomforest_param_grid},</span></span>
<span id="cb51-74"><a href="#cb51-74" aria-hidden="true" tabindex="-1"></a>            <span class="co"># {&#39;modelname&#39;:&#39;XGBoost&#39; , &#39;model_obj&#39;:xgboost_param_grid , &#39;param_values&#39; :xgboost_param_grid}</span></span>
<span id="cb51-75"><a href="#cb51-75" aria-hidden="true" tabindex="-1"></a>           ]</span></code></pre></div>
</div>
<section id="sample-tuning-method-for-decision-tree-with-original-data"
class="cell markdown" id="GMReRXdH_YUd">
<h4>Sample tuning method for Decision tree with original data</h4>
</section>
<div class="cell code" data-execution_count="80"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="o9kks1hG_Xhy" data-outputId="86047259-784a-4c34-892e-22039fc486ec">
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> processingModel <span class="kw">in</span> models:</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Calling RandomizedSearchCV</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    randomized_cv <span class="op">=</span> RandomizedSearchCV(estimator<span class="op">=</span>processingModel[<span class="st">&#39;model_obj&#39;</span>], param_distributions<span class="op">=</span>processingModel[<span class="st">&#39;param_values&#39;</span>], n_iter<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>                                      n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, cv<span class="op">=</span><span class="dv">5</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Fitting parameters in RandomizedSearchCV</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    randomized_cv.fit(X_train,y_train)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Best parameters are Model:</span><span class="sc">{}</span><span class="st">,  </span><span class="sc">{}</span><span class="st"> with CV score=</span><span class="sc">{}</span><span class="st">:&quot;</span> .<span class="bu">format</span>(processingModel[<span class="st">&#39;modelname&#39;</span>], randomized_cv.best_params_,randomized_cv.best_score_))</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best parameters are Model:DecisionTreeModel,  {&#39;min_samples_leaf&#39;: 7, &#39;min_impurity_decrease&#39;: 0.0001, &#39;max_leaf_nodes&#39;: 15, &#39;max_depth&#39;: 5} with CV score=0.9281879415081626:
Best parameters are Model:GBMModel,  {&#39;subsample&#39;: 0.7, &#39;n_estimators&#39;: 125, &#39;max_features&#39;: 0.7, &#39;learning_rate&#39;: 0.2, &#39;init&#39;: AdaBoostClassifier(random_state=1)} with CV score=0.9689611238905375:
Best parameters are Model:AdaBoost,  {&#39;n_estimators&#39;: 90, &#39;learning_rate&#39;: 1, &#39;estimator&#39;: DecisionTreeClassifier(max_depth=2, random_state=1)} with CV score=0.9659976131062168:
Best parameters are Model:BaggingModel,  {&#39;n_estimators&#39;: 70, &#39;max_samples&#39;: 0.9, &#39;max_features&#39;: 0.8} with CV score=0.9648699600757673:
</code></pre>
</div>
</div>
<section
id="sample-tuning-method-for-decision-tree-with-oversampled-data"
class="cell markdown" id="chN8hbfThKyr">
<h4>Sample tuning method for Decision tree with oversampled data</h4>
</section>
<div class="cell code" data-execution_count="83"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="tVZcJ0hv4jau" data-outputId="acc8c76e-c4e3-4418-e26a-d1b6829b5b57">
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> processingModel <span class="kw">in</span> models:</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Calling RandomizedSearchCV</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    randomized_cv <span class="op">=</span> RandomizedSearchCV(estimator<span class="op">=</span>processingModel[<span class="st">&#39;model_obj&#39;</span>], param_distributions<span class="op">=</span>processingModel[<span class="st">&#39;param_values&#39;</span>], n_iter<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                                      n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, cv<span class="op">=</span><span class="dv">5</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Fitting parameters in RandomizedSearchCV</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    randomized_cv.fit(X_train_over,y_train_over)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Best parameters are Model:</span><span class="sc">{}</span><span class="st">,  </span><span class="sc">{}</span><span class="st"> with CV score=</span><span class="sc">{}</span><span class="st">:&quot;</span> .<span class="bu">format</span>(processingModel[<span class="st">&#39;modelname&#39;</span>], randomized_cv.best_params_,randomized_cv.best_score_))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best parameters are Model:DecisionTreeModel,  {&#39;min_samples_leaf&#39;: 7, &#39;min_impurity_decrease&#39;: 0.0001, &#39;max_leaf_nodes&#39;: 15, &#39;max_depth&#39;: 5} with CV score=0.8983893380807556:
Best parameters are Model:GBMModel,  {&#39;subsample&#39;: 1, &#39;n_estimators&#39;: 75, &#39;max_features&#39;: 0.7, &#39;learning_rate&#39;: 0.1, &#39;init&#39;: AdaBoostClassifier(random_state=1)} with CV score=0.9425167343103699:
Best parameters are Model:AdaBoost,  {&#39;n_estimators&#39;: 50, &#39;learning_rate&#39;: 1, &#39;estimator&#39;: DecisionTreeClassifier(max_depth=1, random_state=1)} with CV score=0.930247049639528:
Best parameters are Model:BaggingModel,  {&#39;n_estimators&#39;: 70, &#39;max_samples&#39;: 0.8, &#39;max_features&#39;: 0.7} with CV score=0.9574757418730417:
</code></pre>
</div>
</div>
<section
id="sample-tuning-method-for-decision-tree-with-undersampled-data"
class="cell markdown" id="HtPIiIS7hKyr">
<h4>Sample tuning method for Decision tree with undersampled data</h4>
</section>
<div class="cell code" data-execution_count="84"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="5pbdykhHhKyr" data-outputId="c8d90441-a8c9-4761-8bce-b4e8e494bbb7">
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> processingModel <span class="kw">in</span> models:</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Calling RandomizedSearchCV</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    randomized_cv <span class="op">=</span> RandomizedSearchCV(estimator<span class="op">=</span>processingModel[<span class="st">&#39;model_obj&#39;</span>], param_distributions<span class="op">=</span>processingModel[<span class="st">&#39;param_values&#39;</span>], n_iter<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>                                      n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, cv<span class="op">=</span><span class="dv">5</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Fitting parameters in RandomizedSearchCV</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    randomized_cv.fit(X_train_un,y_train_un)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Best parameters are Model:</span><span class="sc">{}</span><span class="st">,  </span><span class="sc">{}</span><span class="st"> with CV score=</span><span class="sc">{}</span><span class="st">:&quot;</span> .<span class="bu">format</span>(processingModel[<span class="st">&#39;modelname&#39;</span>], randomized_cv.best_params_,randomized_cv.best_score_))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best parameters are Model:DecisionTreeModel,  {&#39;min_samples_leaf&#39;: 7, &#39;min_impurity_decrease&#39;: 0.0001, &#39;max_leaf_nodes&#39;: 15, &#39;max_depth&#39;: 5} with CV score=0.8858646616541354:
Best parameters are Model:GBMModel,  {&#39;subsample&#39;: 0.7, &#39;n_estimators&#39;: 100, &#39;max_features&#39;: 0.5, &#39;learning_rate&#39;: 0.2, &#39;init&#39;: AdaBoostClassifier(random_state=1)} with CV score=0.9442404087140931:
Best parameters are Model:AdaBoost,  {&#39;n_estimators&#39;: 90, &#39;learning_rate&#39;: 1, &#39;estimator&#39;: DecisionTreeClassifier(max_depth=2, random_state=1)} with CV score=0.9376527858106805:
Best parameters are Model:BaggingModel,  {&#39;n_estimators&#39;: 50, &#39;max_samples&#39;: 0.9, &#39;max_features&#39;: 0.7} with CV score=0.9359109311740891:
</code></pre>
</div>
</div>
<section id="model-comparison-and-final-model-selection"
class="cell markdown" id="D9JNnpxa4jau">
<h2>Model Comparison and Final Model Selection</h2>
</section>
<div class="cell markdown" id="-Fg_yuOwlEyL">
<p>Based on above Models comparision GBModel performed well across all
datasets with belwo combination.</p>
<p>Model : GradientBoostingClassifier Best Params : {'subsample': 0.7,
'n_estimators': 125, 'max_features': 0.7, 'learning_rate': 0.2, 'init':
AdaBoostClassifier(random_state=1)} with CV score=0.9689611238905375</p>
</div>
<div class="cell code" data-execution_count="90"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:91}"
id="gAFlcnOplxEh" data-outputId="b0196b1b-493c-4146-b5bf-fbc1b6074338">
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>gbm <span class="op">=</span>GradientBoostingClassifier(n_estimators<span class="op">=</span> <span class="dv">125</span> , max_features<span class="op">=</span> <span class="fl">0.7</span> , learning_rate<span class="op">=</span> <span class="fl">0.2</span> , subsample<span class="op">=</span><span class="fl">0.7</span> )</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the dataset into training and validation sets</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>X_train, X_val, y_train, y_val <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">1</span>)  <span class="co"># Here, 30% of the data is set aside for validation</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>gbm.fit(X_train , y_train )</span></code></pre></div>
<div class="output execute_result" data-execution_count="90">
<style>#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GradientBoostingClassifier(learning_rate=0.2, max_features=0.7,
                           n_estimators=125, subsample=0.7)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">GradientBoostingClassifier</label><div class="sk-toggleable__content"><pre>GradientBoostingClassifier(learning_rate=0.2, max_features=0.7,
                           n_estimators=125, subsample=0.7)</pre></div></div></div></div></div>
</div>
</div>
<section id="test-set-final-performance" class="cell markdown"
id="d_pDMFAz4jav">
<h3>Test set final performance</h3>
</section>
<div class="cell code" data-execution_count="91"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="g8-epsXv4jav" data-outputId="49ebbb96-3fc0-4642-eb75-8d63e0430125">
<div class="sourceCode" id="cb59"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>trin_recall_scores <span class="op">=</span> recall_score(y_train, gbm.predict(X_train))</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>val_recall_scores <span class="op">=</span> recall_score(y_val, gbm.predict(X_val))</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(trin_recall_scores)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(val_recall_scores)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>0.996301899478904
0.9882399059192474
</code></pre>
</div>
</div>
<section id="business-insights-and-conclusions" class="cell markdown"
id="c5hPmHyR4jaw">
<h1>Business Insights and Conclusions</h1>
</section>
<div class="cell code" data-execution_count="94"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="e9pcsmKnoNr0" data-outputId="bc8b26e4-f23b-4586-f312-5a3f9fbba2cc">
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>feature_importances <span class="op">=</span> gbm.feature_importances_</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>feature_importances</span></code></pre></div>
<div class="output execute_result" data-execution_count="94">
<pre><code>array([5.70253131e-03, 1.91528421e-02, 1.07348443e-03, 5.29826138e-03,
       7.35672992e-02, 1.54670500e-02, 1.46805872e-02, 5.14301268e-03,
       1.54835174e-01, 8.49553114e-03, 4.41532240e-02, 3.00531851e-01,
       2.23366378e-01, 1.04534387e-01, 1.82754744e-02, 1.14766119e-03,
       0.00000000e+00, 4.31101391e-05, 0.00000000e+00, 5.88947477e-04,
       5.50704748e-04, 1.48412292e-03, 2.92271252e-04, 1.09027332e-04,
       5.10544669e-05, 4.68196996e-05, 9.99733107e-06, 8.79179110e-05,
       7.12031365e-04, 2.46112658e-04, 3.53133866e-04])</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="92"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="GpwAhzPFnyuh" data-outputId="4ff19d07-fdbc-4b1e-f53d-06d94edf2ec2">
<div class="sourceCode" id="cb63"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>feature_importances <span class="op">=</span> gbm.feature_importances_</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> X_train.columns</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> feature, importance <span class="kw">in</span> <span class="bu">sorted</span>(<span class="bu">zip</span>(features, feature_importances), key<span class="op">=</span><span class="kw">lambda</span> x: <span class="op">-</span>x[<span class="dv">1</span>]):</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Feature: </span><span class="sc">{</span>feature<span class="sc">}</span><span class="ss">, Importance: </span><span class="sc">{</span>importance<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Feature: Total_Trans_Amt, Importance: 0.3005318508705828
Feature: Total_Trans_Ct, Importance: 0.22336637751122984
Feature: Total_Revolving_Bal, Importance: 0.15483517404264446
Feature: Total_Ct_Chng_Q4_Q1, Importance: 0.10453438732619134
Feature: Total_Relationship_Count, Importance: 0.07356729921387324
Feature: Total_Amt_Chng_Q4_Q1, Importance: 0.044153224026100654
Feature: Customer_Age, Importance: 0.01915284212699333
Feature: Avg_Utilization_Ratio, Importance: 0.018275474435311
Feature: Months_Inactive_12_mon, Importance: 0.015467049960447449
Feature: Contacts_Count_12_mon, Importance: 0.014680587190134271
Feature: Avg_Open_To_Buy, Importance: 0.008495531139695247
Feature: CLIENTNUM, Importance: 0.005702531313224169
Feature: Months_on_book, Importance: 0.005298261382601925
Feature: Credit_Limit, Importance: 0.0051430126817195825
Feature: Marital_Status_Married, Importance: 0.0014841229204460853
Feature: Gender_M, Importance: 0.0011476611851247908
Feature: Dependent_count, Importance: 0.0010734844279798078
Feature: Card_Category_Gold, Importance: 0.0007120313651192561
Feature: Education_Level_Post-Graduate, Importance: 0.0005889474768569448
Feature: Education_Level_Uneducated, Importance: 0.0005507047479476226
Feature: Card_Category_Silver, Importance: 0.000353133866137299
Feature: Marital_Status_Single, Importance: 0.0002922712521260176
Feature: Card_Category_Platinum, Importance: 0.00024611265787737935
Feature: Income_Category_$40K - $60K, Importance: 0.00010902733183686629
Feature: Income_Category_abc, Importance: 8.791791104415638e-05
Feature: Income_Category_$60K - $80K, Importance: 5.105446691060164e-05
Feature: Income_Category_$80K - $120K, Importance: 4.681969962468938e-05
Feature: Education_Level_Graduate, Importance: 4.311013914899957e-05
Feature: Income_Category_Less than $40K, Importance: 9.997331069921138e-06
Feature: Education_Level_Doctorate, Importance: 0.0
Feature: Education_Level_High School, Importance: 0.0
</code></pre>
</div>
</div>
<div class="cell markdown" id="VB3eO21n_sgt">
<hr />
</div>
<div class="cell markdown" id="3-rxFmZloabT">
<ul>
<li>Total_Trans_Amt, Importance: 0.3005318508705828</li>
<li>Total_Trans_Ct, Importance: 0.22336637751122984</li>
<li>Total_Revolving_Bal, Importance: 0.15483517404264446</li>
</ul>
<p>Above features are important for customer to reain. By concentrating
and running promotions on transactions amout , number of transactions
etc we can retain more clustomers.</p>
</div>
</body>
</html>
